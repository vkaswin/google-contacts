"use strict";(self.webpackChunkgoogle_contacts=self.webpackChunkgoogle_contacts||[]).push([[395],{3395:(v,l,s)=>{s.r(l),s.d(l,{ContactListPageComponent:()=>x});var t=s(1571),_=s(6895),C=s(8010),h=s(3399),u=s(6572),p=s(1769),d=s(1489);function g(o,i){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"span",4),t._uU(3),t.qZA()(),t.TgZ(4,"div",5)(5,"app-contact-list",6),t.NdJ("onDelete",function(a){t.CHM(e);const c=t.oxw(2);return t.KtG(c.handleDelete(a))})("onFavourite",function(a){t.CHM(e);const c=t.oxw(2);return t.KtG(c.handleFavourite(a))})("onChange",function(a){t.CHM(e);const c=t.oxw(2);return t.KtG(c.handleChange(a))}),t.qZA()(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(3),t.hij("STARRED CONTACTS (",e.starredContactList.length,")"),t.xp6(2),t.Q6J("contacts",e.starredContactList)("isFavourite",!0)("selectedContactIds",e.selectedContactIds)}}function m(o,i){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"span",4),t._uU(3),t.qZA()(),t.TgZ(4,"div",5)(5,"app-contact-list",7),t.NdJ("onDelete",function(a){t.CHM(e);const c=t.oxw(2);return t.KtG(c.handleDelete(a))})("onFavourite",function(a){t.CHM(e);const c=t.oxw(2);return t.KtG(c.handleFavourite(a))})("onChange",function(a){t.CHM(e);const c=t.oxw(2);return t.KtG(c.handleChange(a))}),t.qZA()(),t.BQk()}if(2&o){const e=t.oxw(2);t.xp6(3),t.hij("CONTACTS (",e.contactList.length,")"),t.xp6(2),t.Q6J("contacts",e.contactList)("selectedContactIds",e.selectedContactIds)}}function f(o,i){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-contact-header",1),t.NdJ("onExportContact",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleExportContacts())})("onDeleteSelectedContacts",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleDeleteAllSelectedContacts())})("onClearSelectedContacts",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleClearAllSelectedContacts())}),t.qZA(),t.TgZ(2,"div",2),t.YNc(3,g,6,4,"ng-container",0),t.YNc(4,m,6,3,"ng-container",0),t.qZA(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("isTrash",!1)("selectedContacts",e.selectedContactIds.size),t.xp6(2),t.Q6J("ngIf",0!==e.starredContactList.length),t.xp6(1),t.Q6J("ngIf",0!==e.contactList.length)}}let x=(()=>{class o{constructor(){this.allContacts=[],this.selectedContactIds=new Set,this.contactService=(0,t.f3M)(p.y),this.activatedRoute=(0,t.f3M)(d.gz),this.router=(0,t.f3M)(d.F0),this.snackBar=(0,t.f3M)(C.ux),this.paramSubscribed=!1,this.querySubscribed=!1}get starredContactList(){return this.allContacts.filter(({isFavourite:e})=>e)}get contactList(){return this.allContacts.filter(({isFavourite:e})=>!e)}get labelId(){return this.activatedRoute.snapshot.params.labelId||null}get search(){return this.activatedRoute.snapshot.queryParams.q||null}ngOnInit(){this.getAllContacts(),this.activatedRoute.params.subscribe(()=>{this.paramSubscribed?this.getAllContacts():this.paramSubscribed=!0}),this.activatedRoute.queryParams.subscribe(()=>{this.querySubscribed?this.getAllContacts():this.querySubscribed=!0})}downloadSampleExcelSheet(){this.contactService.downloadSampleFile().subscribe(e=>{let n=document.createElement("a");n.href=URL.createObjectURL(e),n.download="sample-file",n.click()})}getAllContacts(){this.contactService.getAllContacts(this.search,this.labelId).subscribe(({data:{contacts:e}})=>{this.allContacts=e})}handleDelete(e){window.confirm("Are you sure to delete this contact?")&&this.contactService.removeContacts([e]).subscribe(({message:n})=>{this.showSnackBar(n),this.snackBar.open(n);let a=this.allContacts.findIndex(({_id:c})=>c===e);-1!==a&&(this.allContacts.splice(a,1),this.contactService.getContactCount())})}showSnackBar(e){this.snackBar.open(e,"",{duration:3e3})}handleFavourite({contactId:e,isFavourite:n}){n?this.contactService.addToFavourite(e).subscribe(({message:a})=>{this.showSnackBar(a);let c=this.allContacts.find(({_id:r})=>r===e);c&&(c.isFavourite=n,this.contactService.getContactCount())}):this.contactService.removeFromFavourite(e).subscribe(({message:a})=>{this.showSnackBar(a);let c=this.allContacts.find(({_id:r})=>r===e);c&&(c.isFavourite=n,this.contactService.getContactCount())})}handleChange({checked:e,contactId:n}){e?this.selectedContactIds.add(n):this.selectedContactIds.delete(n)}handleClearAllSelectedContacts(){this.selectedContactIds.clear()}handleDeleteAllSelectedContacts(){let e=[...this.selectedContactIds];this.contactService.removeContacts(e).subscribe(({message:n})=>{this.showSnackBar(n),this.allContacts=this.allContacts.filter(({_id:a})=>!this.selectedContactIds.has(a)),this.selectedContactIds=new Set,this.contactService.getContactCount()})}handleExportContacts(){this.contactService.exportContacts().subscribe(e=>{let n=document.createElement("a");n.href=URL.createObjectURL(e),n.download="contacts",n.click()})}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-contact-list-page"]],standalone:!0,features:[t.jDz],decls:1,vars:1,consts:[[4,"ngIf"],[3,"isTrash","selectedContacts","onExportContact","onDeleteSelectedContacts","onClearSelectedContacts"],[1,"relative"],[1,"p-3","sticky","top-[50px]","left-0","z-10","bg-white"],[1,"text-gray","font-medium","text-xs","capitalize"],[1,"flex","flex-col"],[3,"contacts","isFavourite","selectedContactIds","onDelete","onFavourite","onChange"],[3,"contacts","selectedContactIds","onDelete","onFavourite","onChange"]],template:function(e,n){1&e&&t.YNc(0,f,5,4,"ng-container",0),2&e&&t.Q6J("ngIf",0!==n.starredContactList.length||0!==n.contactList.length)},dependencies:[_.ez,_.O5,h.E,u.p,C.ZX],encapsulation:2}),o})()}}]);