"use strict";(self.webpackChunkgoogle_contacts=self.webpackChunkgoogle_contacts||[]).push([[395],{3395:(S,r,s)=>{s.r(r),s.d(r,{ContactListPageComponent:()=>v});var t=s(1571),_=s(6895),C=s(8010),h=s(3399),u=s(2630),p=s(5999),d=s(1489);function g(c,i){1&c&&(t.TgZ(0,"div",2)(1,"span"),t._uU(2,"No Contacts Found"),t.qZA()())}function f(c,i){if(1&c){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",5)(2,"span",6),t._uU(3),t.qZA()(),t.TgZ(4,"div",7)(5,"app-contact-list",8),t.NdJ("onDelete",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleDelete(a))})("onFavourite",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleFavourite(a))})("onChange",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleChange(a))}),t.qZA()(),t.BQk()}if(2&c){const e=t.oxw(2);t.xp6(3),t.hij("STARRED CONTACTS (",e.starredContactList.length,")"),t.xp6(2),t.Q6J("contacts",e.starredContactList)("isFavourite",!0)("selectedContactIds",e.selectedContactIds)}}function m(c,i){if(1&c){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",5)(2,"span",6),t._uU(3),t.qZA()(),t.TgZ(4,"div",7)(5,"app-contact-list",9),t.NdJ("onDelete",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleDelete(a))})("onFavourite",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleFavourite(a))})("onChange",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleChange(a))}),t.qZA()(),t.BQk()}if(2&c){const e=t.oxw(2);t.xp6(3),t.hij("CONTACTS (",e.contactList.length,")"),t.xp6(2),t.Q6J("contacts",e.contactList)("selectedContactIds",e.selectedContactIds)}}function x(c,i){if(1&c){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-contact-header",3),t.NdJ("onExportContact",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleExportContacts())})("onDeleteSelectedContacts",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleDeleteAllSelectedContacts())})("onClearSelectedContacts",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleClearAllSelectedContacts())}),t.qZA(),t.TgZ(2,"div",4),t.YNc(3,f,6,4,"ng-container",1),t.YNc(4,m,6,3,"ng-container",1),t.qZA(),t.BQk()}if(2&c){const e=t.oxw();t.xp6(1),t.Q6J("isTrash",!1)("selectedContacts",e.selectedContactIds.size),t.xp6(2),t.Q6J("ngIf",0!==e.starredContactList.length),t.xp6(1),t.Q6J("ngIf",0!==e.contactList.length)}}let v=(()=>{class c{constructor(){this.allContacts=[],this.selectedContactIds=new Set,this.contactService=(0,t.f3M)(p.y),this.activatedRoute=(0,t.f3M)(d.gz),this.router=(0,t.f3M)(d.F0),this.snackBar=(0,t.f3M)(C.ux),this.paramSubscribed=!1,this.querySubscribed=!1}get starredContactList(){return this.allContacts.filter(({isFavourite:e})=>e)}get contactList(){return this.allContacts.filter(({isFavourite:e})=>!e)}get labelId(){return this.activatedRoute.snapshot.params.labelId||null}get search(){return this.activatedRoute.snapshot.queryParams.q||null}ngOnInit(){this.getAllContacts(),this.contactService.onBulkUpload.subscribe(()=>{console.log("bulk upload"),this.getAllContacts()}),this.activatedRoute.params.subscribe(()=>{this.paramSubscribed?this.getAllContacts():this.paramSubscribed=!0}),this.activatedRoute.queryParams.subscribe(()=>{this.querySubscribed?this.getAllContacts():this.querySubscribed=!0})}getAllContacts(){this.contactService.getAllContacts(this.search,this.labelId).subscribe(({data:{contacts:e}})=>{this.allContacts=e})}handleDelete(e){window.confirm("Are you sure to delete this contact?")&&this.contactService.removeContacts([e]).subscribe(({message:n})=>{this.showSnackBar(n),this.snackBar.open(n);let a=this.allContacts.findIndex(({_id:o})=>o===e);-1!==a&&(this.allContacts.splice(a,1),this.contactService.getContactCount())})}showSnackBar(e){this.snackBar.open(e,"",{duration:3e3})}handleFavourite({contactId:e,isFavourite:n}){n?this.contactService.addToFavourite(e).subscribe(({message:a})=>{this.showSnackBar(a);let o=this.allContacts.find(({_id:l})=>l===e);o&&(o.isFavourite=n,this.contactService.getContactCount())}):this.contactService.removeFromFavourite(e).subscribe(({message:a})=>{this.showSnackBar(a);let o=this.allContacts.find(({_id:l})=>l===e);o&&(o.isFavourite=n,this.contactService.getContactCount())})}handleChange({checked:e,contactId:n}){e?this.selectedContactIds.add(n):this.selectedContactIds.delete(n)}handleClearAllSelectedContacts(){this.selectedContactIds.clear()}handleDeleteAllSelectedContacts(){let e=[...this.selectedContactIds];this.contactService.removeContacts(e).subscribe(({message:n})=>{this.showSnackBar(n),this.allContacts=this.allContacts.filter(({_id:a})=>!this.selectedContactIds.has(a)),this.selectedContactIds=new Set,this.contactService.getContactCount()})}handleExportContacts(){this.contactService.exportContacts().subscribe(e=>{let n=document.createElement("a");n.href=URL.createObjectURL(e),n.download="contacts",n.click()})}}return c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-contact-list-page"]],standalone:!0,features:[t.jDz],decls:2,vars:2,consts:[["class","flex justify-center text-xl p-5 mt-8",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-center","text-xl","p-5","mt-8"],[3,"isTrash","selectedContacts","onExportContact","onDeleteSelectedContacts","onClearSelectedContacts"],[1,"relative"],[1,"p-3","sticky","top-[50px]","left-0","z-10","bg-white"],[1,"text-gray","font-medium","text-xs","capitalize"],[1,"flex","flex-col"],[3,"contacts","isFavourite","selectedContactIds","onDelete","onFavourite","onChange"],[3,"contacts","selectedContactIds","onDelete","onFavourite","onChange"]],template:function(e,n){1&e&&(t.YNc(0,g,3,0,"div",0),t.YNc(1,x,5,4,"ng-container",1)),2&e&&(t.Q6J("ngIf",0===n.allContacts.length),t.xp6(1),t.Q6J("ngIf",0!==n.allContacts.length))},dependencies:[_.ez,_.O5,h.E,u.p,C.ZX],encapsulation:2}),c})()}}]);